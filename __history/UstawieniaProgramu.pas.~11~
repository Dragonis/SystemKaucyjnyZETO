unit UstawieniaProgramu;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes,
  Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Error,
  FireDAC.UI.Intf, FireDAC.Phys.Intf, FireDAC.Stan.Def,
  FireDAC.Stan.Pool, FireDAC.Stan.Async, FireDAC.Phys,
  FireDAC.Phys.SQLite, FireDAC.Phys.SQLiteDef,
  FireDAC.Stan.ExprFuncs, FireDAC.VCLUI.Wait,
  FireDAC.Comp.Client, FireDAC.Comp.DataSet,
  Data.DB, Vcl.Grids, Vcl.DBGrids, FireDAC.Stan.Param, FireDAC.DatS,
  FireDAC.DApt.Intf, FireDAC.DApt;

type
  TUstawieniaProgramuForm = class(TForm)
    FDConnection1: TFDConnection;
    FDQuery1: TFDQuery;
    DataSource1: TDataSource;
    DBGrid1: TDBGrid;
    procedure FormCreate(Sender: TObject);
    procedure FormKeyPress(Sender: TObject; var Key: Char);
  end;

var
  UstawieniaProgramuForm: TUstawieniaProgramuForm;

implementation

{$R *.dfm}

procedure TUstawieniaProgramuForm.FormCreate(Sender: TObject);
var
  Cnt: Integer;
begin
  FDConnection1.Connected := True;

  // tabela
  FDConnection1.ExecSQL(
    'CREATE TABLE IF NOT EXISTS ustawienia (' +
    'id INTEGER PRIMARY KEY AUTOINCREMENT, ' +
    'opis VARCHAR(80), ' +
    'wartosc VARCHAR(80)' +
    ')'
  );

  // sprawdŸ czy s¹ dane
  Cnt := FDConnection1.ExecSQLScalar(
    'SELECT COUNT(*) FROM ustawienia'
  );

  // dane przyk³adowe
  if Cnt = 0 then
  begin
    FDConnection1.ExecSQL(
      'INSERT INTO ustawienia (opis, wartosc) VALUES ' +
      '("Opakowania DRS: sposób tworzenia kodu w³asnego", "wg konfiguracji kodu w³asnego"),' +
      '("Opakowania DRS: wykorzystanie zwolnionych kodów", "tak"),' +
      '("Opakowania DRS: przedrostek kodu w³asnego EAN (200..209)", "200"),' +
      '("Opakowania DRS: pierwszy numer kodu w³asnego", "1001")'
    );
  end;

  // pokaz w DBGrid
  FDQuery1.SQL.Text := 'SELECT * FROM ustawienia';
  FDQuery1.Open;
end;

procedure TUstawieniaProgramuForm.FormKeyPress(Sender: TObject; var Key: Char);
begin
if Key = #27
then // Esc
Close; // wywo³uje OnCloseQuery
end;

end.

